<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>乐游鸟1.0</title>
    <meta name="description" content="leyoubird" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />

    <link rel="shortcut icon" href="">

    <link rel="stylesheet" type="text/css" href="../assets/jquery-mobile/leyoubird.css">
    <link rel="stylesheet" type="text/css" href="../assets/jquery-mobile/jquery.mobile.icons.min.css">
    <link rel="stylesheet" type="text/css" href="../assets/jquery-mobile/jquery.mobile.structure.min.css">

    <link rel="stylesheet" type="text/css" href="../assets/css/leyoubird-mobile.css">

    <link rel="stylesheet" type="text/css" href="../assets/jquery-mobile/jquery.mobile.datepicker.css">
    <link rel="stylesheet" type="text/css" href="../assets/jquery-mobile/jquery.mobile.datepicker.theme.css">

    <script type="text/javascript" src="../assets/js/jquery-1.12.1.min.js"></script>
    <script type="text/javascript" src="../assets/jquery-mobile/jquery.mobile.min.js"></script>
    <script type="text/javascript" src="../assets/js/datepicker.js"></script>
    <script type="text/javascript" src="../assets/jquery-mobile/jquery.mobile.datepicker.js"></script>

    <script type="text/javascript" src="../assets/js/handlebars.js"></script>
    <script type="text/javascript" src="../assets/js/util.js"></script>
    <script type="text/javascript" src="../assets/js/leyoubirds.js"></script>
    
    <script type="text/javascript">
    Handlebars.registerHelper('when', function(key, val, options) {
        if (key == val){
            return options.fn(this);
        }
    });

    window.formData = {
        destinationCity: null,
        departureDate: null,
        days: null,
        numberOfPeople: null,
        departureCity:null
    };

    $(function (){
        var le = new Leyoubird($('#home'));
        le.requestList = {
            't3': {
                url:'http://123.56.194.182:8080/api/custom',
                type:'get',
                data: {},
                onFinish: function (){
                    window.bingAdvScroller($('#adv'));
                    $('#departureDate').date();

                    $('#next').on('click', function (){
                        var destinationCity = $('#destinationCity').val();
                        if (destinationCity && destinationCity.length){
                            destinationCity = destinationCity.join(',');
                        } else {
                            destinationCity = '';
                        }
                        var departureDate = $('input[name=departureDate]').val();
                        var days = $('input[name=days').val();
                        var numberOfPeople = $('input[name=numberOfPeople]').val();
                        var departureCity = $('input[name=departureCity').val();

                        var str = '';
                        if (!destinationCity){
                            str += '目的地, ';
                        }
                        if (!departureDate){
                            str += '日期, ';
                        }
                        if (!days){
                            str += '天数, ';
                        }
                        if (!numberOfPeople){
                            str += '人数, ';
                        }
                        if (!departureCity){
                            str += '出发地';
                        }
                        if (!str){
                            window.formData.destinationCity = destinationCity;
                            window.formData.departureDate = departureDate;
                            window.formData.days = days;
                            window.formData.numberOfPeople = numberOfPeople;
                            window.formData.departureCity = departureCity;
                            le.toPage('t3_1');
                        } else {
                            alert('请输入：' + str);
                        }
                        //le.toPage('t3_1');
                    });
                }
            },
            't3_1': {
                url:'',
                type:'get',
                data: {
                    category:'travel',
                    step:'1.1'
                },
                onFinish: function (){
                    var selectList = function ($target){
                        var $btns = $('.select-btn', $target);
                        $btns.on('click', function (){
                            var $this = $(this);
                            if ($this.hasClass('checked')){
                                $this.removeClass('checked');
                            } else {
                                $btns.removeClass('checked');
                                $this.addClass('checked');
                            }
                        });
                    };
                    selectList($('#fltPref'));
                    selectList($('#accom'));
                    selectList($('#accomType'));
                    selectList($('#trans'));

                    $('#hotel').on('click', function (){
                        if ($(this).hasClass('checked')){
                            $('#accomType').show();
                        }
                    });
                    $('#house').on('click', function (){
                        if ($(this).hasClass('checked')){
                            $('#accomType').hide();
                            $('#accomType .select-btn').removeClass('checked');
                        }
                    });

                    $('#back').on('click', function (){
                        le.toPage('t3');
                    });

                    $('#next').on('click', function (){
                        le.toPage('t3_2');
                    });
                }
            },
            't3_2': {
                url:'',
                type:'get',
                data: {
                    category:'travel',
                    step:'1.1'
                },
                onFinish: function (){
                    $('#back').on('click', function (){
                        le.toPage('t3_1');
                    });
                    window.bindMsgCodeBtn($('#msgBtn'));
                    $('#submit').on('click', function (){
                        le.toPage('t3_3');
                    });
                }
            },
            't3_3': {
                url:'',
                type:'get',
                data: {
                    category:'travel',
                    step:'1.1'
                },
                onFinish: function (){
                    
                }
            },
        }
        le.toPage('t3');
    });
    </script>
</head>
<body class="leyoubird" id="leyoubird">
    <div class="le-loading" id="leLoading">Loading...</div>
    <div data-role="page" id="home"></div>
    <script id="t3" type="text/x-handlebars-template">
        <main role="main" class="ui-content without-header">
            <section class="le-adv-panel narrow customTrip" id="adv">
                <div class="img-panel">
                    {{#each productTopInfos}}
                    <div class="img" style="background-image:url({{imageUrl}})">
                        <span class="img-info">{{imageTitle}}</span>
                    </div>
                    {{/each}}
                </div>
            </section>
            <section class="main-panel">
                <div class="le-form">
                    <form action="">
                        <div class="le-form-item">
                            <label class="le-form-label" for="text-3">目的地</label>
                            <div class="ui-field-contain">
                                <select name="destinationCity" id="destinationCity" multiple="multiple" data-native-menu="false" data-mini="true">
                                    {{#each destCities}}
                                    <option value="{{cityName}}">{{cityName}}</option>
                                    {{/each}}
                                </select>
                            </div>
                        </div>
                        <div class="le-form-item">
                            <label class="le-form-label">日期</label>
                            <input class="le-form-input" type="text" data-clear-btn="false" name="departureDate" id="departureDate" value="" data-role="date" readonly="readonly">
                        </div>
                        <div class="le-form-item">
                            <label class="le-form-label">天数</label>
                            <input class="le-form-input" type="number" data-clear-btn="false" name="days" value="">
                        </div>
                        <div class="le-form-item">
                            <label class="le-form-label">人数</label>
                            <input class="le-form-input" type="number" data-clear-btn="false" name="numberOfPeople" value="">
                        </div>
                        <div class="le-form-item">
                            <label class="le-form-label">出发地</label>
                            <input class="le-form-input" type="text" data-clear-btn="false" name="departureCity" value="">
                        </div>
                    </form>
                </div>
                <div class="le-ctrl-panel">
                    <a id="next" data-ajax="false" class="ui-btn ui-corner-all">下一步</a>
                </div>
            </section>
        </main>
        <footer data-role="footer" class="le-main-footer">
            <div class="le-footer-btn-list">
                <a href="index.html" data-ajax="false" data-transition="fade" class="le-footer-btn">
                    <div class="le-footer-btn-icon">&#xf015c;</div>
                    <div class="le-footer-btn-content">热门推荐</div>
                </a>
                <a href="shuttleService.html" data-ajax="false" data-transition="fade" class="le-footer-btn">
                    <div class="le-footer-btn-icon">&#xe651;</div>
                    <div class="le-footer-btn-content">接送服务</div>
                </a>
                <a class="le-footer-btn focus" data-ajax="false">
                    <div class="le-footer-btn-icon">&#xf0126;</div>
                    <div class="le-footer-btn-content">定制旅行</div>
                </a>
                <a href="deepenExperience.html" data-ajax="false" data-transition="fade" class="le-footer-btn">
                    <div class="le-footer-btn-icon">&#xe64f;</div>
                    <div class="le-footer-btn-content">深度体验</div>
                </a>
                <a href="" class="le-footer-btn" data-ajax="false">
                    <div class="le-footer-btn-icon">&#xf01d8;</div>
                    <div class="le-footer-btn-content">我的旅行</div>
                </a>
            </div>
        </footer>
    </script>
    <script id="t3_1" type="text/x-handlebars-template">
        <header data-role="header" class="le-main-header">
            <!--<a href="about.html" data-transition="slide" class="ui-btn ui-corner-all">Anchor</a>-->
            <span class="home-title">
                <span class="logo"></span>
                <span>乐游鸟旅行</span>
            </span>
            <a id="back" data-ajax="false" class="ui-btn ui-icon-carat-l ui-btn-icon-notext ui-corner-all"></a>
        </header>
        <main role="main" class="ui-content" style="margin-bottom:0">
            <section class="main-panel" style="margin-bottom:0;padding-bottom:1em;">
                <div class="le-items-select">
                    <div class="select-title">航班偏好</div>
                    <div class="select-items" id="fltPref">
                        <div class="select-grid">
                            <div class="select-btn">直飞</div>
                        </div>
                        <div class="select-grid">
                            <div class="select-btn">中转</div>
                        </div>
                    </div>
                    <div class="select-title">住宿类型</div>
                    <div class="select-items" id="accom" style="margin-bottom:0.4em;">
                        <div class="select-grid">
                            <div class="select-btn" id="hotel">度假酒店</div>
                        </div>
                        <div class="select-grid">
                            <div class="select-btn" id="house">特色民宿</div>
                        </div>
                    </div>
                    <div class="select-items" id="accomType" style="display:none;">
                        <div class="select-grid">
                            <div class="select-btn">三星经济</div>
                        </div>
                        <div class="select-grid">
                            <div class="select-btn">四星品质</div>
                        </div>
                        <div class="select-grid">
                            <div class="select-btn">五星豪华</div>
                        </div>
                    </div>
                    <div class="select-title">交通方式</div>
                    <div class="select-items" id="trans">
                        <div class="select-grid" style="width:50%">
                            <div class="select-btn">包车</div>
                        </div>
                        <div class="select-grid">
                            <div class="select-btn">公共交通</div>
                        </div>
                    </div>
                </div>
                <a id="next" class="ui-btn ui-corner-all" data-ajax="false">下一步</a>
            </section>
        </main>
    </script>
    <script id="t3_2" type="text/x-handlebars-template">
        <header data-role="header" class="le-main-header">
            <!--<a href="about.html" data-transition="slide" class="ui-btn ui-corner-all">Anchor</a>-->
            <span class="home-title">
                <span class="logo"></span>
                <span>乐游鸟旅行</span>
            </span>
            <a id="back" data-ajax="false" class="ui-btn ui-icon-carat-l ui-btn-icon-notext ui-corner-all"></a>
        </header>
        <main role="main" class="ui-content" style="margin-bottom:0">
            <section class="main-panel" style="margin-bottom:0;margin-top:3em;">
                <div class="le-form">
                    <form action="">
                        <div class="le-form-item" id="people">
                            <label class="le-form-label" for="text-3">姓名</label>
                            <div class="le-form-grid">
                                <div class="le-form-grid-item">
                                    <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">
                                        <input type="radio" name="radio-choice-h-2" id="radio-choice-h-2a" value="on" checked="checked">
                                        <label for="radio-choice-h-2a">先生</label>
                                        <input type="radio" name="radio-choice-h-2" id="radio-choice-h-2b" value="off">
                                        <label for="radio-choice-h-2b">女士</label>
                                    </fieldset>
                                </div>
                                <div class="le-form-grid-item" style="width:100px;">
                                    <input class="le-form-input" type="text" data-clear-btn="false" name="dest" id="dest" value="">
                                </div>
                            </div>
                        </div>
                        <div class="le-form-item">
                            <label class="le-form-label" for="text-3">手机号</label>
                            <input class="le-form-input" type="number" data-clear-btn="false" name="dest" id="dest" value="">
                            <div class="le-form-grid">
                                <div class="le-form-grid-item" style="width:100px">
                                    <input class="le-form-input" type="number" data-clear-btn="false" name="dest" id="dest" value="" placeholder="验证码">
                                </div>
                                <div class="le-form-grid-item" style="width:100px;">
                                    <div class="le-msgcode-btn" data-ajax="false" id="msgBtn">获取验证码</div>
                                </div>
                            </div>
                        </div>
                        <div class="le-form-item">
                            <label class="le-form-label" for="text-3">邮箱</label>
                            <input class="le-form-input" type="email" data-clear-btn="false" name="dest" id="dest" value="">
                        </div>
                        <div class="le-form-item">
                            <label class="le-form-label" for="text-3">备注</label>
                            <textarea name="textarea-1" id="textarea-1" placeholder="选填,如果有其他需求，可以此处填写"></textarea>
                        </div>
                    </form>
                </div>
                <a id="submit" class="ui-btn ui-corner-all" data-ajax="false">提交</a>
            </section>
        </main>
    </script>
    <script id="t3_3" type="text/x-handlebars-template">
        <header data-role="header" class="le-main-header">
            <!--<a href="about.html" data-transition="slide" class="ui-btn ui-corner-all">Anchor</a>-->
            <span class="home-title">
                <span class="logo"></span>
                <span>乐游鸟旅行</span>
            </span>
        </header>
        <main role="main" class="ui-content" style="margin-bottom:0">
            <section class="main-panel" style="margin-bottom:0;margin-top:3em;">
                <div class="success-panel">
                    <div class="success-title">
                        <span class="icon">&#xf00e1;</span>
                        <span>提交成功</span>
                    </div>
                    <div class="success-content">
                        <p>乐游鸟已了解您的出行需求</p>
                        <p>旅行顾问将24小时内通过电话联系您</p>
                        <p style="margin-top:1em;">感谢您使用乐游鸟旅行定制服务</p>
                    </div>
                </div>
            </section>
            <section class="success-confirm-btn-panel">
                <a href="customTrip.html" data-ajax="false" href="customTrip.html" class="ui-btn ui-corner-all">返回首页</a>
            </section>
        </main>
    </script>
</body>